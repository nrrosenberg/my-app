{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/nicorosenberg/Desktop/my-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import'../styles/login.css';var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.mailInput=React.createRef();_this.passwordInput=React.createRef();_this.state={mail:'',password:'',error:false,token:''};_this.login=_this.login.bind(_assertThisInitialized(_this));return _this;}_createClass(Login,[{key:\"login\",value:function(){var _login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,response,_yield$response$json,token,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.setState({mail:this.mailInput.current.value,password:this.passwordInput.current.value});case 2:data={mail:this.state.mail,password:this.state.password};_context.next=5;return fetch('http://arcane-cove-93049.herokuapp.com/api/auth',{method:'POST',body:JSON.stringify(data)});case 5:response=_context.sent;_context.next=8;return response.json();case 8:_yield$response$json=_context.sent;token=_yield$response$json.token;error=_yield$response$json.error;if(token){this.setState({token:token,error:false});localStorage.setItem('token',token);window.location.reload(false);}else{this.setState({token:'',error:error});localStorage.removeItem('token');}case 12:case\"end\":return _context.stop();}}},_callee,this);}));function login(){return _login.apply(this,arguments);}return login;}()},{key:\"render\",value:function render(){var errorMsg;var error=this.state.error;if(error){errorMsg=/*#__PURE__*/React.createElement(\"h5\",{className:\"errorMsg\"},\"El correo electr\\xF3nico o la contrase\\xF1a se ha introducido de forma incorrecta.\");}return/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Iniciar Sesi\\xF3n\"),errorMsg,/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Mail\",ref:this.mailInput}),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",placeholder:\"Contrase\\xF1a\",ref:this.passwordInput}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",value:\"Iniciar Sesi\\xF3n\",onClick:this.login})));}}]);return Login;}(Component);export{Login as default};","map":{"version":3,"sources":["/Users/nicorosenberg/Desktop/my-app/src/components/Login.jsx"],"names":["React","Component","Login","props","mailInput","createRef","passwordInput","state","mail","password","error","token","login","bind","setState","current","value","data","fetch","method","body","JSON","stringify","response","json","localStorage","setItem","window","location","reload","removeItem","errorMsg"],"mappings":"uzBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAO,qBAAP,C,GAEqBC,CAAAA,K,8FACnB,eAAYC,KAAZ,CAAmB,uCACjB,uBAAMA,KAAN,EACA,MAAKC,SAAL,CAAiBJ,KAAK,CAACK,SAAN,EAAjB,CACA,MAAKC,aAAL,CAAqBN,KAAK,CAACK,SAAN,EAArB,CAEA,MAAKE,KAAL,CAAa,CACXC,IAAI,CAAE,EADK,CAEXC,QAAQ,CAAE,EAFC,CAGXC,KAAK,CAAE,KAHI,CAIXC,KAAK,CAAE,EAJI,CAAb,CAOA,MAAKC,KAAL,CAAa,MAAKA,KAAL,CAAWC,IAAX,+BAAb,CAZiB,aAalB,C,iUAIO,MAAKC,QAAL,CACJ,CAAEN,IAAI,CAAE,KAAKJ,SAAL,CAAeW,OAAf,CAAuBC,KAA/B,CAAsCP,QAAQ,CAAE,KAAKH,aAAL,CAAmBS,OAAnB,CAA2BC,KAA3E,CADI,C,QAGAC,I,CAAO,CACTT,IAAI,CAAE,KAAKD,KAAL,CAAWC,IADR,CAETC,QAAQ,CAAE,KAAKF,KAAL,CAAWE,QAFZ,C,uBAIUS,CAAAA,KAAK,CAAC,iDAAD,CAAoD,CAC9EC,MAAM,CAAE,MADsE,CAE9EC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeL,IAAf,CAFwE,CAApD,C,QAAtBM,Q,qCAKwBA,CAAAA,QAAQ,CAACC,IAAT,E,2CAAvBb,K,sBAAAA,K,CAAOD,K,sBAAAA,K,CACd,GAAIC,KAAJ,CAAU,CACN,KAAKG,QAAL,CAAc,CAACH,KAAK,CAAEA,KAAR,CAAeD,KAAK,CAAE,KAAtB,CAAd,EACAe,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8Bf,KAA9B,EACAgB,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,KAAvB,EACH,CAJD,IAKK,CACD,KAAKf,QAAL,CAAc,CAACH,KAAK,CAAE,EAAR,CAAYD,KAAK,CAAEA,KAAnB,CAAd,EACAe,YAAY,CAACK,UAAb,CAAwB,OAAxB,EACH,C,4KAIM,CACP,GAAIC,CAAAA,QAAJ,CADO,GAECrB,CAAAA,KAFD,CAEW,KAAKH,KAFhB,CAECG,KAFD,CAIP,GAAIA,KAAJ,CAAW,CACTqB,QAAQ,cAAG,0BAAI,SAAS,CAAC,UAAd,uFAAX,CACD,CACD,mBACE,2BAAK,SAAS,CAAC,MAAf,eACE,kDADF,CAEGA,QAFH,cAGE,6CACE,6BAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,MAA/B,CAAsC,GAAG,CAAE,KAAK3B,SAAhD,EADF,cAEE,6BAAO,IAAI,CAAC,UAAZ,CAAuB,WAAW,CAAC,eAAnC,CAAgD,GAAG,CAAE,KAAKE,aAA1D,EAFF,cAGE,6BAAO,IAAI,CAAC,QAAZ,CAAsB,KAAK,CAAE,mBAA7B,CAA8C,OAAO,CAAE,KAAKM,KAA5D,EAHF,CAHF,CADF,CAaD,C,mBA/DgCX,S,SAAdC,K","sourcesContent":["import React, { Component } from 'react';\nimport '../styles/login.css'\n\nexport default class Login extends Component {\n  constructor(props) {\n    super(props);\n    this.mailInput = React.createRef();\n    this.passwordInput = React.createRef();\n\n    this.state = {\n      mail: '',\n      password: '',\n      error: false,\n      token: '',\n    };\n\n    this.login = this.login.bind(this);\n  }\n\n\n  async login() {\n    await this.setState(\n      { mail: this.mailInput.current.value, password: this.passwordInput.current.value },\n    );\n    const data = {\n        mail: this.state.mail,\n        password: this.state.password\n    }\n    const response = await fetch('http://arcane-cove-93049.herokuapp.com/api/auth', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n\n    const {token, error } = await response.json()\n    if (token){\n        this.setState({token: token, error: false})\n        localStorage.setItem('token', token);\n        window.location.reload(false)\n    }\n    else {\n        this.setState({token: '', error: error})\n        localStorage.removeItem('token');\n    }\n   \n  }\n\n  render() {\n    let errorMsg;\n    const { error } = this.state;\n    \n    if (error) {\n      errorMsg = <h5 className=\"errorMsg\">El correo electrónico o la contraseña se ha introducido de forma incorrecta.</h5>;\n    }\n    return (\n      <div className=\"card\">\n        <h2>Iniciar Sesión</h2>\n        {errorMsg}\n        <form>\n          <input type=\"text\" placeholder=\"Mail\" ref={this.mailInput} />\n          <input type=\"password\" placeholder=\"Contraseña\" ref={this.passwordInput} />\n          <input type=\"button\"  value= \"Iniciar Sesión\" onClick={this.login}/>\n          \n            \n        </form>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}